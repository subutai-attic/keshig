<div class="b-popup b-popup_middle">
    <div class="b-popup__header">
        <span ng-if="!keshigCtrl.optionFormUpdate">Add Test option</span>
        <span ng-if="keshigCtrl.optionFormUpdate">Edit Test option</span>
        <a href ng-click="closeThisDialog()">
            <img src="assets/elements/buttons/b-icon-close.svg" class="b-icon g-right"/>
        </a>
    </div>
    <form ng-submit="keshigCtrl.proceedOption(keshigCtrl.currentOption)">
        <div class="b-popup__body">

            <div class="popup-body-box">
                <label class="b-popup-body-label">All</label>
                <input id="test-all"
                       class="b-form-checkbox"
                       type="checkbox"
                       ng-model="keshigCtrl.selectedAllPlaybooks"
                       ng-change="keshigCtrl.addAllPlaybooks()">
                <div class="clear"></div>
            </div>
            <div class="popup-body-box">
                <label class="b-popup-body-label">Name</label>
                <input type="text"
                       ng-model="keshigCtrl.currentOption.name"
                       ng-disabled="keshigCtrl.optionFormUpdate"
                       class="b-popup-body-input b-popup-body-input_box ng-pristine ng-untouched ng-valid"
                       required>
                <div class="clear"></div>
            </div>
            <div class="popup-body-box">
                <div class="b-form__wrapper b-form__wrapper_margin-bottom">
                    <label class="b-form-label b-form-label_fix-size-2 g-left">Playbooks</label>

                    <div class="b-form-wrapper b-form-wrapper_margin-size-2">
                        <div class="b-form-input b-form-input_fix-size-1 b-form-label_margin_r b-form-input_dropdown"
                             checkbox-list-dropdown>
                            <span class="b-form-input__placeholder">Playbooks</span>
                            <ul class="b-form-input-dropdown-list">
                                <li class="b-form-input-dropdown-list-li" ng-repeat="playbook in keshigCtrl.playbooks">
                                    <label class="b-form-input-dropdown-list-li-label">
                                        <input
                                                type="checkbox"
                                                ng-click="keshigCtrl.toggleItem(playbook, keshigCtrl.currentOption.playbooks)"
                                                ng-checked="keshigCtrl.currentOption.playbooks.indexOf(playbook) >= 0">
                                        <span>{{ playbook }}</span>
                                    </label>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="popup-body-box">
                <div class="b-form__wrapper b-form__wrapper_margin-bottom">
                    <label class="b-form-label b-form-label_fix-size-2 g-left">Taget IPs</label>

                    <div class="b-form-wrapper b-form-wrapper_margin-size-2">
                        <div class="b-form-input b-form-input_fix-size-1 b-form-label_margin_r b-form-input_dropdown"
                             checkbox-list-dropdown>
                            <span class="b-form-input__placeholder">Taget IPs</span>
                            <ul class="b-form-input-dropdown-list">
                                <li class="b-form-input-dropdown-list-li" ng-repeat="targetIP in keshigCtrl.targetIPs">
                                    <label class="b-form-input-dropdown-list-li-label">
                                        <input
                                                type="checkbox"
                                                ng-click="keshigCtrl.toggleItem(targetIP, keshigCtrl.currentOption.targetIps)"
                                                ng-checked="keshigCtrl.currentOption.targetIps.indexOf(targetIP) >= 0">
                                        {{ targetIP }}
                                    </label>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="popup-body-box">
                <label class="b-popup-body-label">Enter your own IP</label>
                <input type="text"
                       ng-model="customTargetIP"
                       class="b-popup-body-input b-popup-body-input_box ng-pristine ng-untouched ng-valid">
                <div class="b-btn b-btn_light-grey g-right"
                     style="margin-top: 10px"
                     ng-click="keshigCtrl.addCustomTargetIP(customTargetIP)">
                    Add
                </div>
                <div class="clear"></div>
                <div class="popup-body-box_item">
                    <ul class="b-popup-box__peer-list">
                        <li ng-repeat="additionalIP in keshigCtrl.additionalIPs track by $index"
                            ng-click="keshigCtrl.toggleItem(additionalIP, keshigCtrl.additionalIPs)"
                            class="b-popup-box__peer">
                            <div class="g-left peer-selected" ng-if="keshigCtrl.additionalIPs.indexOf(additionalIP) > -1">
                                <span class="fa fa-check fa-1 b-btn-light-grey-icon_green"></span>
                            </div>
                            <div class="g-right peer-info" ng-class="keshigCtrl.selectedPeers.indexOf(additionalIP) > -1 ? 'peer-selected' : ''">{{additionalIP}}</div>
                            <div class="clear"></div>
                        </li>
                    </ul>
                </div>
                <div class="clear"></div>
            </div>

        </div>
        <div class="b-popup__footer">
            <button class="b-btn b-btn_green g-right" type="submit" ng-disabled="!keshigCtrl.isTestOptionFormValid()">
                <span ng-if="!keshigCtrl.optionFormUpdate">Add</span>
                <span ng-if="keshigCtrl.optionFormUpdate">Update</span>
            </button>
            <div class="clear"></div>
        </div>
    </form>
</div>
